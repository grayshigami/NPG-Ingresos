import{a as E,i as v,_ as c}from"./logo-negro-Sinfondo-DYJ1N-ui.js";import{_ as h,c as d,a as o,t as g,b as u,w as i,v as m,d as f,o as p}from"./index-BF6LzyhM.js";const S={name:"registrar-incidencia",data(){return{name:"",nuevoElemento:{nombre:"",empresa:"",horaEntrada:this.getCurrentTime(),horaSalida:"",comentario:"",usuarioId:null},errorMessage:"",nombresSugeridos:[],empresasSugeridas:[]}},created(){this.nuevoElemento.usuarioId=localStorage.getItem("user_id"),this.name=localStorage.getItem("name")},methods:{getCurrentTime(){const a=new Date,e=a.getFullYear(),s=(a.getMonth()+1).toString().padStart(2,"0"),l=a.getDate().toString().padStart(2,"0");let t=a.getHours().toString().padStart(2,"0"),n=a.getMinutes().toString().padStart(2,"0");return`${e}-${s}-${l}T${t}:${n}`},async agregarElemento(){var a;console.log(this.nuevoElemento);try{this.nuevoElemento.nombre||(this.errorMessage="Debes ingresar el nombre"),this.nuevoElemento.horaEntrada||(this.errorMessage="Debes ingresar la hora de entrada");const e=new Date(this.nuevoElemento.horaEntrada),s=new Date,l=new Date(s);if(l.setDate(s.getDate()-2),e<l){this.errorMessage="No puedes registrar una incidencia anterior a dos días";return}this.nuevoElemento.horaSalida==""&&(this.nuevoElemento.horaSalida=null);const n=(await E.post(`https://${v}:7207/api/Incidencia`,this.nuevoElemento,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data;this.$emit("nuevo-elemento",n),this.nuevoElemento={nombre:"",empresa:"",horaEntrada:"",comentario:""},this.$router.back()}catch(e){console.error("Error al agregar elemento:",((a=e.response)==null?void 0:a.data)||e.message)}},logout(){localStorage.removeItem("token"),window.location.href="/login-component"},goBack(){this.$router.back()}}},b={class:"general"},k={class:"toolbar"},w={class:"b-user"},y={class:"form-data"},D={key:0,class:"err"};function x(a,e,s,l,t,n){return p(),d("div",b,[o("div",k,[e[9]||(e[9]=o("img",{src:c,alt:"",width:"10%",height:"10%"},null,-1)),o("h2",w,"Bienvenido "+g(t.name),1),e[10]||(e[10]=o("div",{class:"spacer"},null,-1)),o("button",{onClick:e[0]||(e[0]=(...r)=>n.logout&&n.logout(...r))},e[8]||(e[8]=[o("i",{class:"fa-solid fa-power-off"},null,-1),u(" Cerrar sesión ")]))]),o("div",y,[e[13]||(e[13]=o("h1",null,"Registrar ingreso",-1)),i(o("input",{type:"text",placeholder:"Nombre","onUpdate:modelValue":e[1]||(e[1]=r=>t.nuevoElemento.nombre=r)},null,512),[[m,t.nuevoElemento.nombre]]),i(o("input",{type:"text",placeholder:"Empresa","onUpdate:modelValue":e[2]||(e[2]=r=>t.nuevoElemento.empresa=r)},null,512),[[m,t.nuevoElemento.empresa]]),i(o("input",{type:"datetime-local",placeholder:"Hora de entrada","onUpdate:modelValue":e[3]||(e[3]=r=>t.nuevoElemento.horaEntrada=r)},null,512),[[m,t.nuevoElemento.horaEntrada]]),i(o("input",{type:"datetime-local",placeholder:"Hora de entrada","onUpdate:modelValue":e[4]||(e[4]=r=>t.nuevoElemento.horaSalida=r)},null,512),[[m,t.nuevoElemento.horaSalida]]),i(o("input",{type:"text",placeholder:"Comentario","onUpdate:modelValue":e[5]||(e[5]=r=>t.nuevoElemento.comentario=r)},null,512),[[m,t.nuevoElemento.comentario]]),o("button",{onClick:e[6]||(e[6]=(...r)=>n.agregarElemento&&n.agregarElemento(...r))},e[11]||(e[11]=[o("i",{class:"fa-solid fa-floppy-disk"},null,-1),u(" Guardar ")])),o("button",{onClick:e[7]||(e[7]=(...r)=>n.goBack&&n.goBack(...r))},e[12]||(e[12]=[o("i",{class:"fa-solid fa-arrow-left"},null,-1),u(" Volver ")])),t.errorMessage?(p(),d("p",D,g(t.errorMessage),1)):f("",!0)])])}const M=h(S,[["render",x]]);export{M as default};
